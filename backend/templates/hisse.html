<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Hisse Eder Fiyatı Hesapla</title>
    <style>
        body { background: #181c20; color: #eaf6ff; font-family: 'Segoe UI', Arial, sans-serif; }
        .container { max-width: 600px; margin: 40px auto; background: #23272b; border-radius: 16px; padding: 32px; box-shadow: 0 2px 16px rgba(44,62,80,0.09); }
        h2 { text-align: center; color: #4fc3f7; }
        label { display: block; margin-top: 18px; }
        input, select { width: 100%; padding: 8px; margin-top: 4px; border-radius: 6px; border: none; background: #1e2a38; color: #eaf6ff; }
        button { margin-top: 24px; width: 100%; padding: 14px; background: linear-gradient(90deg, #1565c0 0%, #00bcd4 100%); color: #fff; border: none; border-radius: 8px; font-size: 1.1rem; cursor: pointer; }
        button:hover { background: linear-gradient(90deg, #00bcd4 0%, #1565c0 100%); }
        .result-box { background: #23272b; border: 1px solid #3a3f47; border-radius: 8px; padding: 22px 28px; margin-top: 30px; font-size: 1.13rem; color: #eaf6ff; }
        .yorum { margin-top: 10px; color: #4fc3f7; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Hisse Eder Fiyatı Hesapla</h2>
        {% if error %}
        <div style="background:#c62828;color:#fff;padding:12px 18px;border-radius:8px;margin-bottom:18px;">{{ error }}</div>
        {% endif %}
        <form method="POST">
            <label>Hisse Adı <input type="text" name="hisse_adi" required value="{{ form_values.hisse_adi|default('') }}"></label>
            <label>Hisse Fiyatı <input type="number" step="0.01" name="hisse_fiyati" required value="{{ form_values.hisse_fiyati|default('') }}"></label>
            <label>Ödenmiş Sermaye <input type="number" step="0.01" name="odenmis_sermaye" required value="{{ form_values.odenmis_sermaye|default('') }}"></label>
            <label>Net Kar <input type="number" step="0.01" name="net_kar" required value="{{ form_values.net_kar|default('') }}"></label>
            <label>Özsermaye <input type="number" step="0.01" name="ozsermaye" required value="{{ form_values.ozsermaye|default('') }}"></label>
            <label>Piyasa Değeri <input type="number" step="0.01" name="piyasa_degeri" required value="{{ form_values.piyasa_degeri|default('') }}"></label>
            <label>F/K Oranı <input type="number" step="0.01" name="fk_orani" required value="{{ form_values.fk_orani|default('') }}"></label>
            <label>PD/DD Oranı <input type="number" step="0.01" name="pddd_orani" required value="{{ form_values.pddd_orani|default('') }}"></label>
            <label>Sektör F/K (opsiyonel) <input type="number" step="0.01" name="sektor_fk" value="{{ form_values.sektor_fk|default('') }}"></label>
            <label>Sektör PD/DD (opsiyonel) <input type="number" step="0.01" name="sektor_pddd" value="{{ form_values.sektor_pddd|default('') }}"></label>
            <label>Analiz Tipi
                <select name="analiz_tipi">
                    <option value="hisse_basi" {% if form_values.analiz_tipi=='hisse_basi' %}selected{% endif %}>Hisse Başı (EPS/BVPS)</option>
                    <option value="toplam" {% if form_values.analiz_tipi=='toplam' %}selected{% endif %}>Toplam Şirket Değeri</option>
                </select>
            </label>
            <button type="submit">Hesapla</button>
        </form>
        {% if results %}
        <div class="result-box">
            <b>{{ results.hisse_adi }}</b> için ortalama eder fiyatı: <b>{{ results.ortalama_fiyat|round(2) }}</b><br>
            Prim potansiyeli: <b>{{ results.prim_potansiyeli|round(2) }}%</b><br>
            <div class="yorum">{{ yorumlar.fk }}</div>
            <div class="yorum">{{ yorumlar.pddd }}</div>
            <div style="margin-top:10px;">Analiz tipi: {{ results.analiz_tipi_aciklama }}</div>
            <div style="margin-top:10px; font-size:0.98em;">Fiyatlar: {{ results.fiyatlar|join(', ') }}</div>
            {% if gemini_analiz %}
            <div style="margin-top:24px; padding:18px; background:#1e2a38; border-radius:8px; border:1px solid #4fc3f7; color:#eaf6ff;">
                <b>Yapay Zeka Analizi:</b><br>
                <div style="margin-top:10px; white-space:pre-line;">{{ gemini_analiz }}</div>
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
    <div style="text-align:center; margin: 32px 0;">
        <a href="/" style="
            display: inline-block;
            background: linear-gradient(90deg, #1565c0 0%, #00bcd4 100%);
            color: #fff;
            padding: 18px 38px;
            border-radius: 12px;
            font-size: 1.25rem;
            font-weight: 600;
            text-decoration: none;
            box-shadow: 0 2px 12px rgba(21,101,192,0.10);
            transition: background 0.2s, color 0.2s, transform 0.15s;
        " onmouseover="this.style.background='linear-gradient(90deg, #00bcd4 0%, #1565c0 100%)'; this.style.color='#eaf6ff';"
          onmouseout="this.style.background='linear-gradient(90deg, #1565c0 0%, #00bcd4 100%)'; this.style.color='#fff';">
            &larr; Ana Sayfaya Dön
        </a>
    </div> 
</body>
</html> 