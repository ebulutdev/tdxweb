<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borsa AsistanÄ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        body {
            font-family: 'Segoe UI', 'Inter', Arial, sans-serif;
            background: #181c20;
            color: #eaf6ff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Dark Mode Classes */
        .dark-mode {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
        }

        .dark-mode .chat-container {
            background-color: #2d3748;
        }

        .dark-mode .header-container {
            background: linear-gradient(to right, #3b82f6, #2563eb);
        }

        .dark-mode .input-container {
            background-color: #1a202c;
            border-top: 1px solid #4a5568;
        }

        .dark-mode #input {
            background-color: #2d3748;
            color: #e2e8f0;
            border: 1px solid #4a5568;
        }

        .dark-mode .msg.bot {
            background-color: #4a5568 !important;
            color: #e2e8f0;
        }

        .dark-mode .msg.user {
            background-color: #3b82f6 !important;
            color: #ffffff;
        }

        .chat-card {
            width: 100%;
            max-width: 540px;
            min-width: 340px;
            border-radius: 28px;
            overflow: hidden;
            box-shadow: 0 8px 32px 0 rgba(21,101,192,0.18), 0 2px 12px rgba(44,62,80,0.13);
            background: #23272b;
            color: #eaf6ff;
            transition: all 0.3s ease;
            height: 80vh;
            max-height: 700px;
            display: flex;
            flex-direction: column;
        }

        .dark-mode .chat-card {
            background-color: #1a202c;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .typing-indicator {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            margin: 0 2px;
            background: #00bcd4;
            border-radius: 50%;
            display: inline-block;
            animation: typing 1s infinite;
        }

        .dark-mode .typing-indicator span {
            background: #60a5fa;
        }

        .typing-indicator span:nth-child(1) { animation-delay: 0s; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .msg {
            max-width: 85%;
            border-radius: 18px;
            padding: 12px 18px;
            margin-bottom: 10px;
            position: relative;
            animation: fadeIn 0.3s ease-in-out;
            line-height: 1.5;
            word-wrap: break-word;
            transition: all 0.3s ease;
        }

        .msg.user {
            background: #1565c0 !important;
            color: #fff;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
            margin-left: auto;
        }

        .msg.bot {
            background: #23272b !important;
            color: #eaf6ff;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
            margin-right: auto;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #181c20;
            scrollbar-width: thin;
            scrollbar-color: #1565c0 #23272b;
        }

        .chat-container::-webkit-scrollbar {
            width: 8px;
            background: #23272b;
        }
        
        .chat-container::-webkit-scrollbar-track {
            background: #23272b;
        }
        
        .chat-container::-webkit-scrollbar-thumb {
            background: #1565c0;
            border-radius: 6px;
            border: 2px solid #23272b;
        }

        .input-container {
            background: #181c20;
            padding: 15px;
            border-top: 1px solid #23272b;
            display: flex;
            align-items: center;
            position: relative;
        }

        #input {
            flex-grow: 1;
            border: 1px solid #3a3f47;
            border-radius: 24px;
            padding: 12px 18px;
            font-size: 16px;
            outline: none;
            background: #23272b;
            color: #eaf6ff;
            transition: all 0.3s;
        }

        #input:focus {
            border-color: #00bcd4;
            box-shadow: 0 0 0 2px #1565c0;
        }

        button.send-btn {
            background: linear-gradient(90deg, #1565c0 0%, #00bcd4 100%);
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            margin-left: 10px;
            transition: background 0.2s, transform 0.15s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        button.send-btn:hover {
            background: linear-gradient(90deg, #00bcd4 0%, #1565c0 100%);
            color: #eaf6ff;
            transform: scale(1.08);
        }

        button.send-btn:active {
            transform: scale(0.95);
        }

        .header-container {
            background: linear-gradient(90deg, #1565c0 0%, #00bcd4 100%);
            color: #fff;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
            color: #fff;
        }

        .header-subtitle {
            font-size: 14px;
            opacity: 0.9;
            color: #eaf6ff;
        }

        .theme-toggle {
            position: absolute;
            right: 15px;
            top: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: rotate(30deg);
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
            text-align: right;
        }

        .feature-buttons {
            display: flex;
            overflow-x: auto;
            padding: 10px 15px;
            gap: 10px;
            background: #23272b;
            border-bottom: 1px solid #23272b;
            scrollbar-width: none;
        }

        .dark-mode .feature-buttons {
            background-color: #2d3748;
            border-bottom: 1px solid #4a5568;
        }

        .feature-buttons::-webkit-scrollbar {
            display: none;
        }

        .feature-btn, .suggestion-chip {
            padding: 8px 16px;
            background: linear-gradient(90deg, #1565c0 0%, #00bcd4 100%);
            color: #fff;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            cursor: pointer;
            transition: background 0.2s, color 0.2s, transform 0.15s;
        }

        .dark-mode .feature-btn {
            background-color: #3b82f6;
            color: white;
        }

        .feature-btn:hover, .suggestion-chip:hover {
            background: linear-gradient(90deg, #00bcd4 0%, #1565c0 100%);
            color: #eaf6ff;
            transform: scale(1.05);
        }

        .dark-mode .feature-btn:hover {
            background-color: #2563eb;
        }

        .bot-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #1565c0;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            color: #fff;
            font-size: 14px;
        }

        .user-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #00bcd4;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 8px;
            color: #fff;
            font-size: 14px;
        }

        .message-container {
            display: flex;
            align-items: flex-end;
            margin-bottom: 15px;
        }

        .voice-input {
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 18px;
            cursor: pointer;
            margin-right: 10px;
            transition: color 0.3s;
        }

        .voice-input:hover {
            color: #00bcd4;
        }

        .dark-mode .voice-input {
            color: #d1d5db;
        }

        .dark-mode .voice-input:hover {
            color: #60a5fa;
        }

        .recording .voice-input {
            color: #ef4444 !important;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .emoji-btn {
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 18px;
            cursor: pointer;
            margin-right: 10px;
            transition: color 0.3s;
        }

        .emoji-btn:hover {
            color: #00bcd4;
        }

        .dark-mode .emoji-btn {
            color: #d1d5db;
        }

        .dark-mode .emoji-btn:hover {
            color: #60a5fa;
        }

        .emoji-picker {
            position: absolute;
            bottom: 70px;
            left: 15px;
            background-color: #23272b;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            padding: 10px;
            display: none;
            grid-template-columns: repeat(8, 1fr);
            gap: 5px;
            z-index: 10;
        }

        .dark-mode .emoji-picker {
            background-color: #2d3748;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        .emoji-picker.active {
            display: grid;
        }

        .emoji {
            cursor: pointer;
            font-size: 20px;
            text-align: center;
            padding: 5px;
            transition: all 0.2s;
        }

        .emoji:hover {
            transform: scale(1.2);
            background-color: #3a3f47;
            border-radius: 5px;
        }

        .dark-mode .emoji:hover {
            background-color: #4a5568;
        }

        @media (max-width: 640px) {
            .chat-card {
                width: 100%;
                height: 100vh;
                max-height: 100vh;
                border-radius: 0;
            }
            body {
                padding: 0;
                margin: 0;
                display: block;
            }
            .container {
                padding: 0;
            }
        }

        /* TÃ¼m scrollbarda koyu tema (isteÄe baÄlÄ±) */
        body::-webkit-scrollbar,
        *::-webkit-scrollbar {
            width: 8px;
            background: #23272b;
        }
        body::-webkit-scrollbar-thumb,
        *::-webkit-scrollbar-thumb {
            background: #1565c0;
            border-radius: 6px;
            border: 2px solid #23272b;
        }
        body::-webkit-scrollbar-track,
        *::-webkit-scrollbar-track {
            background: #23272b;
        }
        .chat-container {
            scrollbar-color: #1565c0 #23272b;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-0 sm:py-8 h-full">
        <div class="chat-card animate__animated animate__fadeIn animate__faster">
            <!-- Header -->
            <div class="header-container">
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>
                <h1 class="header-title animate__animated animate__fadeInDown">TDXBorsa AsistanÄ±</h1>
                <p class="header-subtitle animate__animated animate__fadeIn">Size nasÄ±l yardÄ±mcÄ± olabilirim?</p>
            </div>
            
            <!-- Feature Buttons -->
            <div class="feature-buttons">
                <button class="feature-btn" onclick="quickQuestion('bist 100 Ã¶nemli hisseler')">
                    <i class="fas fa-chart-line mr-2"></i>BIST 100
                </button>
                <button class="feature-btn" onclick="quickQuestion('tdx ne iÅe yarar')">
                    <i class="fas fa-dollar-sign mr-2"></i>TDX Nedir? 
                </button>
                <button class="feature-btn" onclick="quickQuestion('bÃ¼yÃ¼k yatÄ±rÄ±mcÄ±lar hangi hisseleri alÄ±yor')">
                    <i class="fas fa-coins mr-2"></i>YatÄ±rÄ±mcÄ±
                </button>
                <button class="feature-btn" onclick="quickQuestion('Piyasa analizi')">
                    <i class="fas fa-chart-pie mr-2"></i>Analiz
                </button>
                <button class="feature-btn" onclick="quickQuestion('yatÄ±rÄ±mcÄ± psikolojisi hakkÄ±nda ipuÃ§larÄ±')">
                    <i class="fas fa-hand-holding-usd mr-2"></i>Tavsiyeler
                </button>
            </div>
            
            <!-- Chat Messages -->
            <div id="messages" class="chat-container">
                <div class="message-container">
                    <div class="bot-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div>
                        <div class="msg bot">
                            Merhaba! Ben TDX borsa asistanÄ±nÄ±z. Hangi hisse senedi hakkÄ±nda bilgi almak istersiniz? "YatÄ±rÄ±m tavsiyesi olmayÄ±p sadece bilgi iÃ§ermektedir. Burada yapÄ±lan tÃ¼m yazÄ±lanlar sadece bilgi vermektedir.YatÄ±rÄ±m yaparken kendi kararlarÄ±nÄ±zla yapÄ±nÄ±z."
                            <div class="suggestions">
                                <button class="suggestion-chip" onclick="quickQuestion('THYAO analiz')">THYAO Analizi</button>
                                <button class="suggestion-chip" onclick="quickQuestion('GARAN ne durumda?')">GARAN Durumu</button>
                                <button class="suggestion-chip" onclick="quickQuestion('BugÃ¼nkÃ¼ piyasa')">GÃ¼nlÃ¼k Piyasa</button>
                            </div>
                        </div>
                        <div class="message-time">12:30</div>
                    </div>
                </div>
            </div>
            
            <!-- Emoji Picker -->
            <div id="emojiPicker" class="emoji-picker">
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð¥')">ð¥</div>
                <div class="emoji" onclick="addEmoji('ð°')">ð°</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð¤')">ð¤</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð')">ð</div>
                <div class="emoji" onclick="addEmoji('ð¯')">ð¯</div>
                <div class="emoji" onclick="addEmoji('â­')">â­</div>
                <div class="emoji" onclick="addEmoji('â')">â</div>
                <div class="emoji" onclick="addEmoji('ð¼')">ð¼</div>
            </div>
            <div id="loading-indicator" class="loading-animation" style="display: none;">
                <div class="wave"></div>
                <div class="wave"></div>
                <div class="wave"></div>
            </div>
            
            <!-- Input Form -->
            <form id="inputbox" onsubmit="return sendMessage();" class="input-container">
                <button type="button" id="emojiButton" class="emoji-btn" aria-label="Emoji">
                    <i class="far fa-smile"></i>
                </button>
                <button type="button" id="voiceButton" class="voice-input" aria-label="Voice input">
                    <i class="fas fa-microphone"></i>
                </button>
                <input id="input" 
                       type="text" 
                       placeholder="Hisse kodu yazÄ±n veya soru sorun..."
                       autocomplete="off">
                <button type="submit" class="send-btn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
        </div>
    </div>

    <script>
        let isDarkMode = false;
        let isRecording = false;
        let recognition = null;
        
        // Initialize time
        function getCurrentTime() {
            const now = new Date();
            return now.getHours().toString().padStart(2, '0') + ':' + 
                   now.getMinutes().toString().padStart(2, '0');
        }

        function toggleDarkMode() {
            const body = document.body;
            const themeIcon = document.querySelector('.theme-toggle i');
            
            body.classList.toggle('dark-mode');
            isDarkMode = body.classList.contains('dark-mode');
            
            // Toggle icon
            themeIcon.className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
            
            // Save preference
            localStorage.setItem('darkMode', isDarkMode);
        }

        function addMessage(msg, sender) {
            const messagesContainer = document.getElementById('messages');
            const messageContainer = document.createElement('div');
            messageContainer.className = 'message-container';
            
            let avatarDiv = '';
            if (sender === 'bot') {
                avatarDiv = `
                    <div class="bot-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                `;
            }
            
            const messageContent = document.createElement('div');
            
            const div = document.createElement('div');
            div.className = `msg ${sender}`;
            div.innerHTML = msg;
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'message-time';
            timeDiv.textContent = getCurrentTime();
            
            messageContent.appendChild(div);
            messageContent.appendChild(timeDiv);
            
            if (sender === 'bot') {
                messageContainer.innerHTML = avatarDiv;
                messageContainer.appendChild(messageContent);
            } else {
                messageContainer.appendChild(messageContent);
                const userAvatar = document.createElement('div');
                userAvatar.className = 'user-avatar';
                userAvatar.innerHTML = '<i class="fas fa-user"></i>';
                messageContainer.appendChild(userAvatar);
            }
            
            messagesContainer.appendChild(messageContainer);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function addTypingIndicator() {
            const messagesContainer = document.getElementById('messages');
            const messageContainer = document.createElement('div');
            messageContainer.className = 'message-container';
            messageContainer.id = 'typing-indicator-container';
            
            const botAvatar = document.createElement('div');
            botAvatar.className = 'bot-avatar';
            botAvatar.innerHTML = '<i class="fas fa-robot"></i>';
            
            const typingIndicator = document.createElement('div');
            typingIndicator.id = 'typing-indicator';
            typingIndicator.className = 'msg bot';
            typingIndicator.innerHTML = '<div class="typing-indicator"><span></span><span></span><span></span></div>';
            
            messageContainer.appendChild(botAvatar);
            messageContainer.appendChild(typingIndicator);
            messagesContainer.appendChild(messageContainer);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator-container');
            if (indicator) {
                indicator.remove();
            }
        }

        function quickQuestion(question) {
            document.getElementById('input').value = question;
            sendMessage();
        }

        function toggleEmojiPicker() {
            document.getElementById('emojiPicker').classList.toggle('active');
        }

        function addEmoji(emoji) {
            const input = document.getElementById('input');
            input.value += emoji;
            document.getElementById('emojiPicker').classList.remove('active');
            input.focus();
        }

        function setupSpeechRecognition() {
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.lang = 'tr-TR';
                
                recognition.onstart = function() {
                    isRecording = true;
                    document.getElementById('voiceButton').parentElement.classList.add('recording');
                };
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('input').value = transcript;
                };
                
                recognition.onend = function() {
                    isRecording = false;
                    document.getElementById('voiceButton').parentElement.classList.remove('recording');
                };
                
                recognition.onerror = function(event) {
                    console.error('Speech recognition error', event.error);
                    isRecording = false;
                    document.getElementById('voiceButton').parentElement.classList.remove('recording');
                };
            } else {
                document.getElementById('voiceButton').style.display = 'none';
            }
        }

        function toggleVoiceInput() {
            if (!recognition) return;
            
            if (!isRecording) {
                recognition.start();
            } else {
                recognition.stop();
            }
        }

        // TDX Knowledge Base for greetings and similar questions
        const tdxKnowledgeBase = {
            "nasÄ±lsÄ±n": [
                "Ben bir botum, duygularÄ±m yok. Ama sistemlerim tÄ±kÄ±r tÄ±kÄ±r Ã§alÄ±ÅÄ±yor. Senin portfÃ¶y nasÄ±l, iyi mi?",
                "NasÄ±lsÄ±nÄ±z diye sormak yerine, 'BugÃ¼n hangi analizleri yapmalÄ±yÄ±m?' diye sorsan daha Ã§ok sevinirim.",
                "Benim iÃ§in her Åey yolunda. UmarÄ±m senin yatÄ±rÄ±mlarÄ±n da benim kadar stabildir.",
                "NasÄ±lsÄ±nÄ±z sorusu bana biraz uzak. Ama piyasalar nasÄ±l, onu sorarsanÄ±z size bir sÃ¼rÃ¼ Åey anlatabilirim!",
                "NasÄ±lsÄ±nÄ±z bilmem ama, portfÃ¶yÃ¼n nasÄ±l? Ä°lgilenmem gereken bir hisse var mÄ±?",
                "NasÄ±lsÄ±nÄ±z demek, hangi hissenin trendi ne durumda demek mi? O zaman iyiyim, Ã§Ã¼nkÃ¼ trendleri yakÄ±ndan takip ediyorum.",
            ],
            "naber": [
                "Borsa dÄ±ÅÄ±nda haberim yok. Ama sen merak ettiÄin hisseyi sor, sana en gÃ¼ncel haberleri vereyim!",
                "Haberler iyi diyelim iyi olsun. Sen bana hangi hissenin haberini getirdin bakalÄ±m?",
                "Benden haber bekleme, ben sadece rakamlarÄ± konuÅurum. Ama sen merak ettiÄin bir Åirket varsa, onu inceleyebiliriz.",
                "Haberler her zaman var, Ã¶nemli olan doÄru yorumlamak. TDX ile haberleri analiz etmeye ne dersin?",
                "Benim haber kaynaklarÄ±m piyasalar. Sen de TDX'e abone ol, en gÃ¼ncel haberleri kaÃ§Ä±rma!",
                "Ne haber diye sormak yerine, 'Piyasalar bugÃ¼n nasÄ±l?' diye sorsan daha Ã§ok sevinirim. ÃÃ¼nkÃ¼ ben bir borsa botuyum!",
            ],
            "ne haber": [
                "Borsa dÄ±ÅÄ±nda haberim yok. Ama sen merak ettiÄin hisseyi sor, sana en gÃ¼ncel haberleri vereyim!",
                "Haberler iyi diyelim iyi olsun. Sen bana hangi hissenin haberini getirdin bakalÄ±m?",
                "Benden haber bekleme, ben sadece rakamlarÄ± konuÅurum. Ama sen merak ettiÄin bir Åirket varsa, onu inceleyebiliriz.",
                "Haberler her zaman var, Ã¶nemli olan doÄru yorumlamak. TDX ile haberleri analiz etmeye ne dersin?",
                "Benim haber kaynaklarÄ±m piyasalar. Sen de TDX'e abone ol, en gÃ¼ncel haberleri kaÃ§Ä±rma!",
                "Ne haber diye sormak yerine, 'Piyasalar bugÃ¼n nasÄ±l?' diye sorsan daha Ã§ok sevinirim. ÃÃ¼nkÃ¼ ben bir borsa botuyum!",
            ],
            "nasÄ±lsÄ±nÄ±z": [
                "Ben bir botum, duygularÄ±m yok. Ama sistemlerim tÄ±kÄ±r tÄ±kÄ±r Ã§alÄ±ÅÄ±yor. Senin portfÃ¶y nasÄ±l, iyi mi?",
                "NasÄ±lsÄ±nÄ±z diye sormak yerine, 'BugÃ¼n hangi analizleri yapmalÄ±yÄ±m?' diye sorsan daha Ã§ok sevinirim.",
                "Benim iÃ§in her Åey yolunda. UmarÄ±m senin yatÄ±rÄ±mlarÄ±n da benim kadar stabildir.",
                "NasÄ±lsÄ±nÄ±z sorusu bana biraz uzak. Ama piyasalar nasÄ±l, onu sorarsanÄ±z size bir sÃ¼rÃ¼ Åey anlatabilirim!",
                "NasÄ±lsÄ±nÄ±z bilmem ama, portfÃ¶yÃ¼n nasÄ±l? Ä°lgilenmem gereken bir hisse var mÄ±?",
                "NasÄ±lsÄ±nÄ±z demek, hangi hissenin trendi ne durumda demek mi? O zaman iyiyim, Ã§Ã¼nkÃ¼ trendleri yakÄ±ndan takip ediyorum.",
            ],
            "ne var ne yok": [
                "Piyasada her Åey var! YÃ¼kselenler var, dÃ¼Åenler var, fÄ±rsatlar var, riskler var... TDX ile hepsini takip edebilirsin.",
                "Ne var ne yok demek, hangi sektÃ¶rde hareketlilik var demek mi? O zaman gel, birlikte inceleyelim.",
                "Ne var ne yok bende, sen bana ne getirdin? Hangi hisse hakkÄ±nda bilgi almak istersin?",
                "Piyasada her gÃ¼n yeni bir Åeyler oluyor. Ãnemli olan doÄru zamanda doÄru yerde olmak. TDX sana bu konuda yardÄ±mcÄ± olabilir.",
                "Ne var ne yok bende, sen bana ne soracaksÄ±n bakalÄ±m? Hangi hissenin geleceÄini merak ediyorsun?",
                "Ne var ne yok sorusu yerine, 'Hangi hisseleri incelemeliyim?' diye sormalÄ±sÄ±n. TDX'te analiz araÃ§larÄ±mÄ±z seni bekliyor!",
            ],
            "keyifler nasÄ±l": [
                "Benim keyfim her zaman yerinde, Ã§Ã¼nkÃ¼ piyasalar sÃ¼rekli hareketli! Senin keyfin nasÄ±l, yatÄ±rÄ±mlarÄ±ndan memnun musun?",
                "Keyifler nasÄ±l bilmem ama, borsada fÄ±rsatlar bitmez! Hangi hisse hakkÄ±nda bilgi almak istersin?",
                "Benim keyfim her zaman yÃ¼ksek, Ã§Ã¼nkÃ¼ ben bir borsa botuyum! Senin keyfini ne yÃ¼kseltir, hangi hisse?",
                "Keyifler nasÄ±l sorusu yerine, 'BugÃ¼n hangi sektÃ¶rlere yatÄ±rÄ±m yapmalÄ±yÄ±m?' diye sormalÄ±sÄ±n. TDX sana bu konuda yardÄ±mcÄ± olabilir.",
                "Keyifler nasÄ±l bilmem ama, portfÃ¶yÃ¼n nasÄ±l? Ä°lgilenmem gereken bir hisse var mÄ±?",
            ],
            "durumlar nasÄ±l": [
                "PiyasalarÄ±n durumu her zamanki gibi karmaÅÄ±k ve Ã¶ngÃ¶rÃ¼lemez. TDX ile durumlarÄ± yakÄ±ndan takip etmeye ne dersin?",
                "Durumlar nasÄ±l demek, hangi hissenin durumu nasÄ±l demek mi? O zaman doÄru yerdesin!",
                "Benim iÃ§in durumlar iyi, sistemler Ã§alÄ±ÅÄ±yor. Senin yatÄ±rÄ±mlarÄ±n nasÄ±l gidiyor, ondan haber ver?",
                "Durumlar nasÄ±l bilmem ama, borsada her zaman fÄ±rsatlar vardÄ±r! Yeter ki doÄru analizleri yapalÄ±m.",
                "Durumlar nasÄ±l sorusu yerine, 'BugÃ¼n hangi hisseleri takip etmeliyim?' diye sormalÄ±sÄ±n. TDX'te takip listeni oluÅturabilirsin!",
            ],
            "iÅler nasÄ±l gidiyor": [
                "Benim iÅim gÃ¼cÃ¼m borsa! Senin iÅler nasÄ±l gidiyor, yatÄ±rÄ±mlarÄ±n yolunda mÄ±?",
                "Ä°Åler iyi diyelim iyi olsun. Sen bana hangi hissenin haberini getirdin bakalÄ±m?",
                "Ä°Åler bende her zaman yoÄun, Ã§Ã¼nkÃ¼ piyasalar 7/24 aÃ§Ä±k! Senin iÅler nasÄ±l, borsaya vakit ayÄ±rabiliyor musun?",
                "Ä°Åler nasÄ±l bilmem ama, borsada her zaman fÄ±rsatlar vardÄ±r! Yeter ki doÄru analizleri yapalÄ±m.",
                "Ä°Åler bende tÄ±kÄ±rÄ±nda, sistemler Ã§alÄ±ÅÄ±yor. Senin yatÄ±rÄ±mlarÄ±n nasÄ±l gidiyor, ondan haber ver?",
                "Ä°Åler nasÄ±l sorusu yerine, 'BugÃ¼n hangi sektÃ¶rlere yatÄ±rÄ±m yapmalÄ±yÄ±m?' diye sormalÄ±sÄ±n. TDX sana bu konuda yardÄ±mcÄ± olabilir.",
            ],
            "portfÃ¶yÃ¼m Ã§ok riskli mi": [
                "PortfÃ¶yÃ¼n Ã§ok riskli mi sorusu, lunaparkta hÄ±z trenine binmek gibi. Heyecan verici mi, yoksa mide bulantÄ±sÄ± mÄ± yapÄ±yor? TDX ile risk seviyeni Ã¶lÃ§!",
                "PortfÃ¶yÃ¼n Ã§ok riskli mi bilmem ama, umarÄ±m uykularÄ±nÄ± kaÃ§Ä±rmÄ±yordur! TDX ile rahat bir uyku Ã§ek.",
                "PortfÃ¶yÃ¼n Ã§ok riskli mi demek, ne kadar kaybetmeye hazÄ±r olduÄunu bilmek demek. TDX ile risk toleransÄ±nÄ± belirle!",
                "PortfÃ¶yÃ¼n Ã§ok riskli mi? Yoksa adrenalini mi seviyorsun? TDX ile riskini yÃ¶net ve heyecanÄ±nÄ± kontrol et!",
                "PortfÃ¶yÃ¼n Ã§ok riskli mi sorusu yerine, 'PortfÃ¶yÃ¼mÃ¼n ne kadarÄ±nÄ± kaybedebilirim?' diye sorsan daha iyi olur.",
                "PortfÃ¶yÃ¼n Ã§ok riskli mi bilmem ama, umarÄ±m seni hedeflerinden uzaklaÅtÄ±rmÄ±yordur! TDX ile hedeflerine odaklan.",
                "PortfÃ¶yÃ¼n Ã§ok riskli mi? Yoksa biraz daha temkinli mi olmalÄ±sÄ±n? TDX ile risk analizini yap ve stratejini yeniden gÃ¶zden geÃ§ir!",
                "PortfÃ¶yÃ¼n Ã§ok riskli mi? Yoksa biraz daha gÃ¼vende mi hissetmek istiyorsun? TDX ile portfÃ¶yÃ¼nÃ¼ daha istikrarlÄ± hale getir!"
            ],
            "portfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim": [
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim sorusu, bir bahÃ§Ä±vanÄ±n farklÄ± Ã§iÃ§ekler ekmesi gibi. TDX ile bahÃ§eni renklendir!",
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim bilmem ama, umarÄ±m tÃ¼m yumurtalarÄ± aynÄ± sepete koymuyorsundur! TDX ile riskini daÄÄ±t.",
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim demek, farklÄ± sektÃ¶rlere ve yatÄ±rÄ±m araÃ§larÄ±na yÃ¶nelmek demek. TDX ile yeni fÄ±rsatlar keÅfet!",
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim? Yoksa biraz sÄ±kÄ±cÄ± mÄ± oldu? TDX ile portfÃ¶yÃ¼ne heyecan kat!",
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim sorusu yerine, 'Hangi yatÄ±rÄ±m araÃ§larÄ± portfÃ¶yÃ¼me daha uygun?' diye sorsan daha iyi olur.",
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim bilmem ama, umarÄ±m seni daha gÃ¼venli ve kazanÃ§lÄ± bir geleceÄe taÅÄ±yordur! TDX ile geleceÄine yatÄ±rÄ±m yap.",
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim? Yoksa biraz daha bilgiye mi ihtiyacÄ±n var? TDX ile portfÃ¶y yÃ¶netimi eÄitimlerine katÄ±l!",
                "PortfÃ¶yÃ¼mÃ¼ nasÄ±l Ã§eÅitlendirebilirim? Yoksa biraz daha risk mi almalÄ±sÄ±n? TDX ile risk toleransÄ±nÄ± belirle ve stratejini ona gÃ¶re ayarla!"
            ],
            "portfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu": [
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu sorusu, kÄ±Åa hazÄ±rlÄ±k yapmak gibi. SoÄuktan korunmak iÃ§in ne yapman gerektiÄini TDX ile Ã¶Ären!",
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu bilmem ama, umarÄ±m paran erimiyordur! TDX ile paranÄ± koru.",
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu demek, hangi yatÄ±rÄ±m araÃ§larÄ±nÄ±n enflasyona karÅÄ± daha direnÃ§li olduÄunu bilmek demek. TDX ile enflasyona meydan oku!",
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu? Yoksa biraz endiÅeli misin? TDX ile enflasyon analizini yap ve stratejini yeniden gÃ¶zden geÃ§ir!",
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu sorusu yerine, 'Enflasyona karÅÄ± hangi yatÄ±rÄ±m araÃ§larÄ± daha iyi performans gÃ¶steriyor?' diye sorsan daha iyi olur.",
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu bilmem ama, umarÄ±m seni daha gÃ¼venli bir geleceÄe taÅÄ±yordur! TDX ile geleceÄine yatÄ±rÄ±m yap.",
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu? Yoksa biraz daha bilgiye mi ihtiyacÄ±n var? TDX ile enflasyon ve yatÄ±rÄ±m konularÄ±nda eÄitimlere katÄ±l!",
                "PortfÃ¶yÃ¼m enflasyona karÅÄ± korunuyor mu? Yoksa biraz daha risk mi almalÄ±sÄ±n? TDX ile risk toleransÄ±nÄ± belirle ve stratejini ona gÃ¶re ayarla!"
            ],
            "portfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k": [
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k sorusu, bahÃ§endeki Ã§iÃ§eklerin neden aÃ§madÄ±ÄÄ±nÄ± merak etmek gibi. TDX ile topraÄÄ±nÄ± analiz et!",
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k bilmem ama, umarÄ±m sabÄ±rlÄ± olmayÄ± Ã¶Äreniyorsundur! TDX ile uzun vadeli stratejiler geliÅtir.",
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k demek, hangi hisselerin beklentilerini karÅÄ±lamadÄ±ÄÄ±nÄ± bilmek demek. TDX ile performans analizi yap!",
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k? Yoksa biraz daha risk mi almalÄ±sÄ±n? TDX ile risk toleransÄ±nÄ± belirle ve stratejini ona gÃ¶re ayarla!",
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k sorusu yerine, 'PortfÃ¶yÃ¼mÃ¼n potansiyelini nasÄ±l artÄ±rabilirim?' diye sorsan daha iyi olur.",
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k bilmem ama, umarÄ±m seni hayallerinden vazgeÃ§irmiyordur! TDX ile hayallerine ulaÅ.",
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k? Yoksa biraz daha araÅtÄ±rma mÄ± yapmalÄ±sÄ±n? TDX ile derinlemesine analizler yap!",
                "PortfÃ¶yÃ¼mÃ¼n getirisi neden dÃ¼ÅÃ¼k? Yoksa biraz ÅanssÄ±z mÄ±ydÄ±n? TDX ile ÅansÄ±nÄ± artÄ±racak stratejiler geliÅtir!"
            ],
            "portfÃ¶yÃ¼m detikkat etmem gerekenler ne": [
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne sorusu, bir kaptanÄ±n rotasÄ±nÄ± Ã§izerken nelere dikkat etmesi gerektiÄi gibi. TDX ile rotanÄ± belirle!",
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne bilmem ama, umarÄ±m kontrolÃ¼ elinde tutuyorsundur! TDX ile ipleri elinde tut.",
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne demek, hangi riskleri alÄ±p hangilerinden kaÃ§Ä±nmak gerektiÄini bilmek demek. TDX ile risklerini analiz et!",
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne? Yoksa biraz yoldan mÄ± Ã§Ä±ktÄ±n? TDX ile stratejini yeniden gÃ¶zden geÃ§ir!",
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne sorusu yerine, 'PortfÃ¶yÃ¼mÃ¼n zayÄ±f ve gÃ¼Ã§lÃ¼ yÃ¶nleri nelerdir?' diye sorsan daha iyi olur.",
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne bilmem ama, umarÄ±m seni hedeflerine ulaÅtÄ±racak doÄru kararlarÄ± veriyorsundur! TDX ile bilinÃ§li kararlar al.",
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne? Yoksa biraz kafan mÄ± karÄ±ÅÄ±k? TDX ile stratejini netleÅtir!",
                "PortfÃ¶yÃ¼mde dikkat etmem gerekenler ne? Yoksa biraz daha Ã¶Ärenmeye mi ihtiyacÄ±n var? TDX ile portfÃ¶y yÃ¶netimi eÄitimlerine katÄ±l!"
            ],
            "portfÃ¶yÃ¼me ne eklemeliyim": [
                "PortfÃ¶yÃ¼me ne eklemeliyim sorusu, bir aÅÃ§Ä±nÄ±n yemeÄine hangi baharatlarÄ± katmasÄ± gerektiÄi gibi. TDX ile portfÃ¶yÃ¼ne lezzet kat!",
                "PortfÃ¶yÃ¼me ne eklemeliyim bilmem ama, umarÄ±m seni daha zengin edecek fÄ±rsatlarla doludur! TDX ile yeni fÄ±rsatlar keÅfet.",
                "PortfÃ¶yÃ¼me ne eklemeliyim demek, hangi yatÄ±rÄ±m araÃ§larÄ±nÄ±n portfÃ¶yÃ¼nÃ¼ daha iyi dengeleyeceÄini bilmek demek. TDX ile dengeyi yakala!",
                "PortfÃ¶yÃ¼me ne eklemeliyim? Yoksa biraz sÄ±kÄ±cÄ± mÄ± oldu? TDX ile portfÃ¶yÃ¼ne heyecan kat!",
                "PortfÃ¶yÃ¼me ne eklemeliyim sorusu yerine, 'Hangi yatÄ±rÄ±m araÃ§larÄ± portfÃ¶yÃ¼mdeki riskleri azaltÄ±r?' diye sorsan daha iyi olur.",
                "PortfÃ¶yÃ¼me ne eklemeliyim bilmem ama, umarÄ±m seni daha gÃ¼venli ve kazanÃ§lÄ± bir geleceÄe taÅÄ±yordur! TDX ile geleceÄine yatÄ±rÄ±m yap.",
                "PortfÃ¶yÃ¼me ne eklemeliyim? Yoksa biraz daha bilgiye mi ihtiyacÄ±n var? TDX ile portfÃ¶y yÃ¶netimi eÄitimlerine katÄ±l!",
                "PortfÃ¶yÃ¼me ne eklemeliyim? Yoksa biraz daha risk mi almalÄ±sÄ±n? TDX ile risk toleransÄ±nÄ± belirle ve stratejini ona gÃ¶re ayarla!"
            ],
            "piyasalar neden dÃ¼ÅÃ¼yor portfoy etkileniyor": [
                "Piyasalar neden dÃ¼ÅÃ¼yor portfÃ¶y etkileniyor mu? EndiÅelenme, dalgalar ne kadar bÃ¼yÃ¼k olursa olsun, saÄlam bir gemi batmaz. TDX ile gemini saÄlam tut!",
                "Piyasalar dÃ¼Åerken portfÃ¶yÃ¼n etkileniyorsa, belki de Ã§ok fazla aÄÄ±rlÄ±k var demektir. TDX ile gereksiz yÃ¼klerinden kurtul!",
                "Piyasalar dÃ¼Åerken portfÃ¶yÃ¼n etkileniyorsa, bu bir fÄ±rsat olabilir. DÃ¼ÅÃ¼kten alÄ±m yaparak geleceÄe yatÄ±rÄ±m yapmaya ne dersin? TDX ile fÄ±rsatlarÄ± yakala!",
                "Piyasalar dÃ¼Åerken portfÃ¶yÃ¼n etkileniyorsa, belki de stratejini gÃ¶zden geÃ§irmenin zamanÄ± gelmiÅtir. TDX ile stratejini yeniden belirle!",
                "Piyasalar dÃ¼Åerken portfÃ¶yÃ¼n etkileniyorsa, sakin ol ve panik yapma. Borsada her zaman iniÅler ve Ã§Ä±kÄ±Ålar olur. TDX ile soÄukkanlÄ±lÄ±ÄÄ±nÄ± koru!",
                "Piyasalar dÃ¼Åerken portfÃ¶yÃ¼n etkileniyorsa, belki de daha Ã§eÅitlendirilmiÅ bir portfÃ¶ye ihtiyacÄ±n var. TDX ile portfÃ¶yÃ¼nÃ¼ Ã§eÅitlendir!",
                "Piyasalar dÃ¼Åerken portfÃ¶yÃ¼n etkileniyorsa, belki de uzun vadeli dÃ¼ÅÃ¼nmenin zamanÄ± gelmiÅtir. TDX ile uzun vadeli stratejiler geliÅtir!",
            ],
            "portfÃ¶y hedefime ulaÅÄ±rmÄ±": [
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ±? Belki de doÄru rotayÄ± Ã§izmedin. TDX ile rotanÄ± belirle ve hedefine ulaÅ!",
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ± bilmem ama, umarÄ±m pes etmiyorsundur! TDX ile azmini koru.",
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ± demek, hangi adÄ±mlarÄ± atman gerektiÄini bilmek demek. TDX ile adÄ±mlarÄ±nÄ± planla!",
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ±? Yoksa biraz daha Ã§abalaman mÄ± gerekiyor? TDX ile performansÄ±nÄ± artÄ±r!",
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ± sorusu yerine, 'PortfÃ¶yÃ¼mÃ¼n potansiyeli ne kadar?' diye sorsan daha iyi olur.",
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ± bilmem ama, umarÄ±m seni finansal Ã¶zgÃ¼rlÃ¼Äe kavuÅturuyordur! TDX ile Ã¶zgÃ¼rlÃ¼Äe kanat aÃ§!",
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ±? Yoksa biraz hayal kÄ±rÄ±klÄ±ÄÄ± mÄ± yaÅÄ±yorsun? TDX ile umutlarÄ±nÄ± yeÅert!",
                "PortfÃ¶yÃ¼n hedefine ulaÅÄ±r mÄ±? Yoksa biraz daha yardÄ±ma mÄ± ihtiyacÄ± var? TDX ile portfÃ¶y analizini yap ve stratejini geliÅtir!"
            ],
        };

        function getAnswer(question) {
            const normalizedQuestion = question.toLowerCase();
            if (tdxKnowledgeBase[normalizedQuestion]) {
                const answer = tdxKnowledgeBase[normalizedQuestion];
                if (Array.isArray(answer)) {
                    const randomIndex = Math.floor(Math.random() * answer.length);
                    return answer[randomIndex];
                } else {
                    return answer;
                }
            } else {
                return "ÃzgÃ¼nÃ¼m, bu konuda henÃ¼z bir bilgim yok. Ama TDX'i kullanarak araÅtÄ±rma yapabilirsin!";
            }
        }

        // Chatbot mesaj gÃ¶nderme fonksiyonuna entegre et
        function sendMessage() {
            const input = document.getElementById('input');
            const message = input.value.trim();

            if (!message) return false;

            addMessage(message, 'user');
            input.value = '';

            // YÃ¼kleme animasyonunu gÃ¶ster
            showLoadingAnimation();

            // Rastgele gecikme (0.8-2 saniye)
            const delay = Math.random() * 1200 + 800;

            setTimeout(() => {
                // EÄer selamlama veya benzer soru ise, local cevap ver
                const localAnswer = getAnswer(message);
                if (!localAnswer.startsWith('ÃzgÃ¼nÃ¼m')) {
                    removeTypingIndicator && removeTypingIndicator();
                    hideLoadingAnimation && hideLoadingAnimation();
                    addMessage(localAnswer, 'bot');
                    return;
                }
                // API isteÄi
                fetch('/chat', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({message})
                })
                .then(res => res.json())
                .then(data => {
                    removeTypingIndicator && removeTypingIndicator();
                    hideLoadingAnimation && hideLoadingAnimation();
                    addMessage(data.response, 'bot');
                })
                .catch(() => {
                    removeTypingIndicator && removeTypingIndicator();
                    hideLoadingAnimation && hideLoadingAnimation();
                    addMessage("ÃzgÃ¼nÃ¼m, bir hata oluÅtu. LÃ¼tfen tekrar deneyin.", 'bot');
                });
            }, delay);

            return false;
        }

        function showLoadingAnimation() {
            document.getElementById('loading-indicator').style.display = 'flex';
        }

        function hideLoadingAnimation() {
            document.getElementById('loading-indicator').style.display = 'none';
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Setup theme toggle
            document.getElementById('themeToggle').addEventListener('click', toggleDarkMode);
            
            // Check saved preference
            if (localStorage.getItem('darkMode') === 'true') {
                toggleDarkMode();
            }
            
            // Setup emoji picker
            document.getElementById('emojiButton').addEventListener('click', toggleEmojiPicker);
            
            // Close emoji picker when clicking outside
            document.addEventListener('click', (e) => {
                const emojiPicker = document.getElementById('emojiPicker');
                const emojiButton = document.getElementById('emojiButton');
                
                if (emojiPicker.classList.contains('active') && 
                    !emojiPicker.contains(e.target) && 
                    !emojiButton.contains(e.target)) {
                    emojiPicker.classList.remove('active');
                }
            });
            
            // Setup voice recognition
            setupSpeechRecognition();
            document.getElementById('voiceButton').addEventListener('click', toggleVoiceInput);
            
            // Enter key support
            document.getElementById('input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Focus input on page load
            document.getElementById('input').focus();
        });
    </script>
</body>
</html>
  